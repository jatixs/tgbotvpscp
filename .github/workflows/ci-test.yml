# .github/workflows/autofix.yml

name: CI - –ê–≤—Ç–æ–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∏–ª—è –∫–æ–¥–∞

on:
  push:
    branches: [ main, develop ]

jobs:
  autofix:
    name: FIX üé® –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (autopep8)
    runs-on: ubuntu-latest

    steps:
      # 1. –ü–æ–ª—É—á–∞–µ–º –∫–æ–¥ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
      - name: ‚¨áÔ∏è –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–¥–∞
        uses: actions/checkout@v4
        with:
          # –ù—É–∂–µ–Ω —Ç–æ–∫–µ–Ω, —á—Ç–æ–±—ã –∫–æ–º–º–∏—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ–±—Ä–∞—Ç–Ω–æ –≤ —Ä–µ–ø–æ
          token: ${{ secrets.GITHUB_TOKEN }}

      # 2. –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º Python 3.10
      - name: üêç –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Python 3.10
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'

      # 3. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞–≤—Ç–æ—Ñ–æ—Ä–º–∞—Ç—Ç–µ—Ä
      - name: üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ autopep8
        run: |
          pip install autopep8

      # 4. –ó–ê–ü–£–°–ö –ê–í–¢–û–ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø
      # autopep8 –∏—Å–ø—Ä–∞–≤–∏—Ç –≤—Å–µ –æ—à–∏–±–∫–∏ E* –∏ W* (–æ—Ç—Å—Ç—É–ø—ã, –ø—Ä–æ–±–µ–ª—ã –∏ —Ç.–¥.)
      - name: üé® –ó–∞–ø—É—Å–∫ –∞–≤—Ç–æ–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        run: |
          echo "ü§ñ –ó–∞–ø—É—Å–∫–∞—é –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è..."
          # --in-place : –∏—Å–ø—Ä–∞–≤–∏—Ç—å —Ñ–∞–π–ª—ã –Ω–∞ –º–µ—Å—Ç–µ
          # --recursive . : –¥–ª—è –≤—Å–µ—Ö .py —Ñ–∞–π–ª–æ–≤ –≤ –ø—Ä–æ–µ–∫—Ç–µ
          # --aggressive --aggressive : –ø—Ä–∏–º–µ–Ω—è–µ—Ç –±–æ–ª–µ–µ –º–æ—â–Ω—ã–µ (–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ) –ø—Ä–∞–≤–∏–ª–∞
          autopep8 --in-place --recursive . --aggressive --aggressive

      # 5. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ (–∫–æ–º–º–∏—Ç) –∏–∑–º–µ–Ω–µ–Ω–∏–π
      # –≠—Ç–æ—Ç —à–∞–≥ –ø—Ä–æ–≤–µ—Ä–∏—Ç, –±—ã–ª–∏ –ª–∏ –≤–Ω–µ—Å–µ–Ω—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
      # –ï—Å–ª–∏ –¥–∞ - –æ–Ω —Å–æ–∑–¥–∞—Å—Ç –Ω–æ–≤—ã–π –∫–æ–º–º–∏—Ç –æ—Ç –∏–º–µ–Ω–∏ "GitHub Actions"
      - name: üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: "style: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω —Å—Ç–∏–ª—å –∫–æ–¥–∞ (autopep8)"
          commit_user_name: GitHub Actions [bot]
          commit_user_email: actions@github.com
          commit_author: GitHub Actions [bot] <actions@github.com>
